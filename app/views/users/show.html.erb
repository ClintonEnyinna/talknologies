<div class="container-fluid">
  <div class="row" style="min-height: calc(100vh - 73px);">
    <%= render 'shared/leftnav' %>
    <main class="col-sm-7 p-0 bg-light border-right">
      <div class="cover">
        <%= image_tag(@user.cover_photo, class: 'cover-img') if current_user.cover %>
      </div>
      <nav class="nav px-5 mb-5 border-bottom d-flex align-items-center">
        <div class="">
          <%= link_to 'TWEETS', root_path, class: 'nav-link main-nav active text-dark px-0' %>
        </div>
        <div class="ml-auto">
          <% unless current_user?(@user) %>
            <% unless current_user.cannot_follow?(@user) %>
              <%= button_to 'FOLLOW', {controller: "friendships", action: "create", id: @user.id}, method: :post, class: 'btn btn-outline-primary' %>
            <% else %>
              <%= button_to 'UNFOLLOW', {controller: "friendships", action: "destroy", id: @user.id}, method: :delete, class: 'btn btn-outline-danger' %>
            <% end %>
          <% end %>
        </div>
      </nav>
      <div>
        <div class="container px-5">
          <%= render 'shared/tweets' %>
        </div>
      </div>
    </main>
    <aside class="col-sm-3 bg-light">
      <div class="">
        <div class="text-center d-flex flex-column align-items-stretch" style="height: 400px;">
          <div class="pt-5">
            <%= image_tag(@user.profile, class: "profile-img") %>
          </div>
          <div class="card-body pb-4">
            <p class="mb-0"> <%= @user.fullname %> </p>
            <p class="text-muted text-extra-small"> @<%= @user.username %> </p>
          </div>
          <div class="row border-top border-bottom">
            <div class="col-sm-4 border-right py-3">
              <div class = ""><%= @opinions.count %></div>
              <h6 class="mb-0 text-muted">Tweets</h6>
            </div>
            <div class="col-sm-4 border-right py-3">
              <div class = ""><%= @user.followees.count %></div>
              <h6 class="mb-0 text-muted">Following</h6>
            </div>
            <div class="col-sm-4 py-3">
              <div class = ""><%= @user.followers.count %></div>
              <h6 class="mb-0 text-muted">Followers</h6>
            </div>
          </div> 
        </div>
      </div>
      <div class="border-bottom d-flex align-items-center" style="height: 82px">
        <h6 class="text-muted pl-2 mb-0"> FOLLOWED BY </h6>
      </div>
      <div class="container py-4">
        <% @user.followers.each do |user| %>
            <div class="card mb-4 border-0 bg-transparent">
                <div class="row no-gutters">
                  <div class="col-sm-2 text-center">
                    <%= image_tag(user.thumbnail, class: 'side-thumbnail') %>
                  </div>
                  <div class="col-sm-10">
                    <div class="card-body p-0">
                      <h6 class="card-title mb-0"><%= link_to user.fullname, user_path(user), class: 'text-body font-weight-bold text-decoration-none' %></h6>
                      <small class="text-muted">@<%=user.username%></small>
                    </div>
                  </div>
                </div>
            </div>
        <% end %>
      </div>
    </aside>
  </div>
</div>